!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.blockjsShare=t()}(this,function(){"use strict";function e(e){var t=document.createElement("a");return t.href=e,t.href}function t(e,t){var n=new RegExp("(?|&)"+key+"=($|&)","g");return path.replace(n,"$1")}function n(e,t,n){return e+(location.href.match("?")?"&":"?")+t+"="+n}function a(e,t,a,i,r){return n(e,t,a.replace("FROM",i).replace("TO",r))}function i(e){l=e,w||(w=!0,r())}function r(){"undefined"!=typeof top.window.WeixinJSBridge&&top.window.WeixinJSBridge.invoke?c():document.addEventListener?document.addEventListener("WeixinJSBridgeReady",c,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",c),document.attachEvent("onWeixinJSBridgeReady",c))}function c(){var e=WeixinJSBridge,t=function(t){e.log(t.err_msg)};e.on(k+"qq",function(){e.invoke("shareQQ",{title:l.title,desc:l.desc,img_url:l.imageUrl,link:a(l.url,l.adtagName,l.adtagVal,S,h)},t),l.onShareSuccess&&l.onShareSuccess()}),e.on(k+"QZone",function(){e.invoke("shareQZone",{title:l.title,desc:l.desc,img_url:l.imageUrl,link:a(l.url,l.adtagName,l.adtagVal,S,f)},t),l.onShareSuccess&&l.onShareSuccess()}),e.on(k+"timeline",function(n){e.invoke("shareTimeline",{img_width:x,img_height:x,title:l.wxTitle||l.title,desc:l.desc,img_url:l.imageUrl,link:a(l.url,l.adtagName,l.adtagVal,S,p)},t),l.onShareSuccess&&l.onShareSuccess()}),e.on(k+"appmessage",function(n){e.invoke("sendAppMessage",{img_url:l.imageUrl,img_width:x,img_height:x,link:a(l.url,l.adtagName,l.adtagVal,S,S),title:l.title,desc:l.desc},t),l.onShareSuccess&&l.onShareSuccess()})}function o(e){m=e,setTimeout(function(){mqq.ui.setOnShareHandler(function(e){_(e)})},200)}function u(e){if(g=e,window.QZAppExternal){var t=g.adtagName,n=g.adtagVal,i=g.url,r=g.imgUrl,c=g.title,o=g.desc,u=g.wxTitle;window.QZAppExternal.setShare(function(e){},{type:"share",image:[r,r,r,r,r],title:[c,c,c,c,u||c],summary:[o,o,o,o,o],shareURL:[a(i,t,n,f,v),a(i,t,n,f,f),a(i,t,n,f,h),a(i,t,n,f,S),a(i,t,n,f,p)]})}}function s(e){e=d(e),i(e),o(e),u(e)}function d(n){var a=n.url,i=n.title,r=n.desc,c=n.wxTitle,o=n.imgUrl,u=n.puin,s=n.sourceName,d=n.adtagName,l=n.adtagVal,m=n.onShareSuccess,g=d||"adtag";return{title:i||document.title,desc:r,url:t(e(a||location.href),g),imgUrl:e(o),wxTitle:c||void 0,puin:u||void 0,sourceName:s||void 0,adtagName:g,adtagVal:l||"FROM_to_TO",onShareSuccess:m}}var l,m,g,h="qq",f="qzone",S="wx",p="timeline",v="other",w=!1,x=120,k="menu:share:",_=function(e){var t=m.url,n=m.adtagName,i=m.adtagVal,r=m.title,c=m.wxTitle,o=m.desc;m.imgUrl;switch(e){case 0:a(t,n,i,h,h);break;case 1:a(t,n,i,h,f);break;case 2:a(t,n,i,h,S);break;case 3:a(t,n,i,h,p)}var u=3==e?c||r:r,s={title:u,desc:o,share_type:e,back:!0,image_url:m.imgUrl,share_url:shareUrl};void 0!==m.puin&&(s.puin=m.puin),void 0!==m.sourceName&&(s.sourceName=m.sourceName),mqq.ui.shareMessage(s,function(e){m.onShareSuccess&&m.onShareSuccess()})};return s});