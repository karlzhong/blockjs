!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.blockjsShare=t()}(this,function(){"use strict";function e(e){var t=document.createElement("a");return t.href=e,t.href}function t(e,t){var n=new RegExp("(\\?|&)"+t+"=.*?($|&)","g");return e.replace(n,"$1")}function n(e,t,n){var i=e.split("#"),a=i[0],r=i[1];return a+(e.indexOf("?")!=-1?"&":"?")+t+"="+n+(r?"#"+r:"")}function i(e,t,i,a,r){return n(e,t,i.replace("FROM",a).replace("TO",r))}function a(e){d=e,_||(_=!0,r())}function r(){"undefined"!=typeof top.window.WeixinJSBridge&&top.window.WeixinJSBridge.invoke?c():document.addEventListener?document.addEventListener("WeixinJSBridgeReady",c,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",c),document.attachEvent("onWeixinJSBridgeReady",c))}function c(){var e=WeixinJSBridge,t=function(t){e.log(t.err_msg)};e.on(x+"qq",function(){e.invoke("shareQQ",{title:d.title,desc:d.desc,img_url:d.imgUrl,link:i(d.url,d.adtagName,d.adtagVal,S,f)},t),d.onShareSuccess&&d.onShareSuccess()}),e.on(x+"QZone",function(){e.invoke("shareQZone",{title:d.title,desc:d.desc,img_url:d.imgUrl,link:i(d.url,d.adtagName,d.adtagVal,S,h)},t),d.onShareSuccess&&d.onShareSuccess()}),e.on(x+"timeline",function(n){e.invoke("shareTimeline",{img_width:w,img_height:w,title:d.wxTitle||d.title,desc:d.desc,img_url:d.imgUrl,link:i(d.url,d.adtagName,d.adtagVal,S,p)},t),d.onShareSuccess&&d.onShareSuccess()}),e.on(x+"appmessage",function(n){e.invoke("sendAppMessage",{img_url:d.imgUrl,img_width:w,img_height:w,link:i(d.url,d.adtagName,d.adtagVal,S,S),title:d.title,desc:d.desc},t),d.onShareSuccess&&d.onShareSuccess()})}function o(e){m=e,setTimeout(function(){mqq.ui.setOnShareHandler(function(e){k(e)})},200)}function s(e){if(g=e,window.QZAppExternal){var t=g.adtagName,n=g.adtagVal,a=g.url,r=g.imgUrl,c=g.title,o=g.desc,s=g.wxTitle;window.QZAppExternal.setShare(function(e){},{type:"share",image:[r,r,r,r,r],title:[c,c,c,c,s||c],summary:[o,o,o,o,o],shareURL:[i(a,t,n,h,v),i(a,t,n,h,h),i(a,t,n,h,f),i(a,t,n,h,S),i(a,t,n,h,p)]})}}function u(e){e=l(e),a(e),o(e),s(e)}function l(n){var i=n.url,a=n.title,r=n.desc,c=n.wxTitle,o=n.imgUrl,s=n.puin,u=n.sourceName,l=n.adtagName,d=n.adtagVal,m=n.onShareSuccess,g=n.src_iconUrl,f=n.src_action,h=n.src_actionData,S=l||"adtag";return{title:a||document.title,desc:r,url:t(e(i||location.href),S),imgUrl:e(o),wxTitle:c||void 0,puin:s||void 0,sourceName:u||void 0,adtagName:S,adtagVal:d||"FROM_to_TO",onShareSuccess:m,src_iconUrl:g,src_action:f,src_actionData:h}}var d,m,g,f="qq",h="qzone",S="wx",p="timeline",v="other",_=!1,w=120,x="menu:share:",k=function(e){var t,n=m.url,a=m.adtagName,r=m.adtagVal,c=m.title,o=m.wxTitle,s=m.desc;m.imgUrl;switch(e){case 0:t=i(n,a,r,f,f);break;case 1:t=i(n,a,r,f,h);break;case 2:t=i(n,a,r,f,S);break;case 3:t=i(n,a,r,f,p)}var u=3==e?o||c:c,l={title:u,desc:s,share_type:e,back:!0,image_url:m.imgUrl,share_url:t},d=["puin","sourceName","src_iconUrl","src_action","src_actionData"];for(var g in d){var v=d[g];void 0!==m[v]&&(l[v]=m[v])}mqq.ui.shareMessage(l,function(e){m.onShareSuccess&&m.onShareSuccess()})};return u});