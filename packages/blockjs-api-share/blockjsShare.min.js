!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.blockjsShare=t()}(this,function(){"use strict";function e(e){var t=document.createElement("a");return t.href=e,t.href}function t(e,t){var n=new RegExp("(\\?|&)"+t+"=($|&)","g");return e.replace(n,"$1")}function n(e,t,n){return e+(location.href.indexOf("?")!=-1?"&":"?")+t+"="+n}function i(e,t,i,a,r){return n(e,t,i.replace("FROM",a).replace("TO",r))}function a(e){l=e,w||(w=!0,r())}function r(){"undefined"!=typeof top.window.WeixinJSBridge&&top.window.WeixinJSBridge.invoke?c():document.addEventListener?document.addEventListener("WeixinJSBridgeReady",c,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",c),document.attachEvent("onWeixinJSBridgeReady",c))}function c(){var e=WeixinJSBridge,t=function(t){e.log(t.err_msg)};e.on(k+"qq",function(){e.invoke("shareQQ",{title:l.title,desc:l.desc,img_url:l.imgUrl,link:i(l.url,l.adtagName,l.adtagVal,S,h)},t),l.onShareSuccess&&l.onShareSuccess()}),e.on(k+"QZone",function(){e.invoke("shareQZone",{title:l.title,desc:l.desc,img_url:l.imgUrl,link:i(l.url,l.adtagName,l.adtagVal,S,f)},t),l.onShareSuccess&&l.onShareSuccess()}),e.on(k+"timeline",function(n){e.invoke("shareTimeline",{img_width:x,img_height:x,title:l.wxTitle||l.title,desc:l.desc,img_url:l.imgUrl,link:i(l.url,l.adtagName,l.adtagVal,S,p)},t),l.onShareSuccess&&l.onShareSuccess()}),e.on(k+"appmessage",function(n){e.invoke("sendAppMessage",{img_url:l.imgUrl,img_width:x,img_height:x,link:i(l.url,l.adtagName,l.adtagVal,S,S),title:l.title,desc:l.desc},t),l.onShareSuccess&&l.onShareSuccess()})}function o(e){m=e,setTimeout(function(){mqq.ui.setOnShareHandler(function(e){_(e)})},200)}function u(e){if(g=e,window.QZAppExternal){var t=g.adtagName,n=g.adtagVal,a=g.url,r=g.imgUrl,c=g.title,o=g.desc,u=g.wxTitle;window.QZAppExternal.setShare(function(e){},{type:"share",image:[r,r,r,r,r],title:[c,c,c,c,u||c],summary:[o,o,o,o,o],shareURL:[i(a,t,n,f,v),i(a,t,n,f,f),i(a,t,n,f,h),i(a,t,n,f,S),i(a,t,n,f,p)]})}}function s(e){e=d(e),a(e),o(e),u(e)}function d(n){var i=n.url,a=n.title,r=n.desc,c=n.wxTitle,o=n.imgUrl,u=n.puin,s=n.sourceName,d=n.adtagName,l=n.adtagVal,m=n.onShareSuccess,g=d||"adtag";return{title:a||document.title,desc:r,url:t(e(i||location.href),g),imgUrl:e(o),wxTitle:c||void 0,puin:u||void 0,sourceName:s||void 0,adtagName:g,adtagVal:l||"FROM_to_TO",onShareSuccess:m}}var l,m,g,h="qq",f="qzone",S="wx",p="timeline",v="other",w=!1,x=120,k="menu:share:",_=function(e){var t,n=m.url,a=m.adtagName,r=m.adtagVal,c=m.title,o=m.wxTitle,u=m.desc;m.imgUrl;switch(e){case 0:t=i(n,a,r,h,h);break;case 1:t=i(n,a,r,h,f);break;case 2:t=i(n,a,r,h,S);break;case 3:t=i(n,a,r,h,p)}var s=3==e?o||c:c,d={title:s,desc:u,share_type:e,back:!0,image_url:m.imgUrl,share_url:t};void 0!==m.puin&&(d.puin=m.puin),void 0!==m.sourceName&&(d.sourceName=m.sourceName),mqq.ui.shareMessage(d,function(e){m.onShareSuccess&&m.onShareSuccess()})};return s});